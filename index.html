<!doctype html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Smooth Photo Viewer</title>

<link href="https://fonts.googleapis.com/css2?family=Hind:wght@400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --w:min(95vw,650px);
  --h:min(80vh,780px);
}

*{box-sizing:border-box}

body{
  margin:0;
  min-height:100vh;
  display:grid;
  place-items:center;
  font-family:Hind,sans-serif;
  background:linear-gradient(135deg,#3a2a1c,#2b1b0f);
}

/* controls */
.topbar{
  position:fixed;
  top:12px;
  left:0;
  right:0;
  display:flex;
  justify-content:center;
  gap:10px;
}

button{
  padding:8px 15px;
  border:none;
  border-radius:30px;
  cursor:pointer;
  font-weight:bold;
}

/* viewer */
.viewer{
  width:var(--w);
  height:var(--h);
  background:black;
  position:relative;
  overflow:hidden;
  display:flex;
  justify-content:center;
  align-items:center;
}

/* images stacked */
.viewer img{
  position:absolute;
  width:100%;
  height:100%;
  object-fit:contain;
  opacity:0;
  transition:opacity .45s ease;
}

/* visible layer */
.show{opacity:1}

/* counter */
.counter{
  position:absolute;
  top:10px;
  right:10px;
  color:white;
  background:rgba(0,0,0,.4);
  padding:6px 12px;
  border-radius:20px;
}
</style>
</head>

<body>

<div class="topbar">
<button id="prevBtn">⬅ Prev</button>
<button id="nextBtn">Next ➡</button>
</div>

<div class="viewer" id="viewer">
<img id="imgA">
<img id="imgB">
<div class="counter" id="counter"></div>
</div>

<script>
/* photos */
const photos=[
"a.jpg","b.jpg","c.jpg","n.jpg","m.jpg","e.jpg","f.jpg","g.jpg"
];

let index=0;

const imgA=document.getElementById("imgA");
const imgB=document.getElementById("imgB");
const counter=document.getElementById("counter");

let active=imgA;
let nextImg=imgB;

/* preload image first (KEY FIX) */
function preload(src){
  return new Promise(resolve=>{
    const i=new Image();
    i.src=src;
    i.onload=()=>resolve(src);
  });
}

/* update counter */
function updateCounter(){
  counter.textContent=(index+1)+" / "+photos.length;
}

/* ultra smooth change */
async function show(newIndex){
  if(newIndex<0||newIndex>=photos.length) return;

  // preload next image first
  const src=await preload(photos[newIndex]);

  nextImg.src=src;

  // crossfade
  nextImg.classList.add("show");
  active.classList.remove("show");

  // swap layers
  [active,nextImg]=[nextImg,active];

  index=newIndex;
  updateCounter();
}

function next(){show(index+1)}
function prev(){show(index-1)}

nextBtn.onclick=next;
prevBtn.onclick=prev;

/* swipe */
let startX=0;
viewer.addEventListener("pointerdown",e=>{
  startX=e.clientX;
});

viewer.addEventListener("pointerup",e=>{
  let dx=e.clientX-startX;
  if(dx<-60) next();
  if(dx>60) prev();
});

/* first image load */
imgA.src=photos[0];
imgA.onload=()=>{
  imgA.classList.add("show");
  updateCounter();
};
</script>

</body>
</html>