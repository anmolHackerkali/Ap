<!doctype html>
<html lang="hi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>Photo Album Flip Book</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Hind:wght@400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --w: min(92vw, 980px);
  --h: min(78vh, 560px);
  --radius: 18px;
}

*{ box-sizing:border-box; }

body{
  margin:0;
  min-height:100vh;
  display:grid;
  place-items:center;
  font-family:"Hind", sans-serif;
  overflow:hidden;

  background:
    radial-gradient(circle at 20% 20%, rgba(255,255,255,.08), transparent 40%),
    radial-gradient(circle at 80% 80%, rgba(255,255,255,.05), transparent 40%),
    repeating-linear-gradient(
      45deg,
      #5a3e2b,
      #5a3e2b 10px,
      #4a3222 10px,
      #4a3222 20px
    );
}

/* Controls */
.topbar{
  position:fixed;
  top:15px;
  left:0;
  right:0;
  display:flex;
  justify-content:center;
  z-index:100;
}
.pill{
  background:rgba(0,0,0,.4);
  padding:10px 15px;
  border-radius:50px;
  backdrop-filter: blur(6px);
}
button{
  padding:8px 15px;
  border:none;
  border-radius:30px;
  cursor:pointer;
  font-weight:bold;
}
button:hover{ opacity:.85 }

/* Book */
.stage{
  width:var(--w);
  height:var(--h);
  perspective:2000px;

  /* ‚úÖ swipe/drag ke liye */
  touch-action: pan-y;
  user-select: none;
  -webkit-user-select: none;
}

.book{
  width:100%;
  height:100%;
  position:relative;
  transform-style:preserve-3d;
  border-radius:var(--radius);
  box-shadow:0 40px 60px rgba(0,0,0,.6);
}

/* Album cover */
.cover{
  position:absolute;
  inset:0;
  background:linear-gradient(135deg,#3a2a1c,#2b1b0f);
  border-radius:var(--radius);
  box-shadow:inset 0 0 0 3px rgba(0,0,0,.5);
  transform:translateZ(-4px);
}

/* Spread */
.pages{
  position:absolute;
  inset:25px;
  border-radius:14px;
  overflow:hidden;
  transform-style:preserve-3d;
}

.baseSpread{
  position:absolute;
  inset:0;
  display:flex;
}

/* 2 page halves */
.half{
  width:50%;
  height:100%;
  background-size:200% 100%;
  background-repeat:no-repeat;
}

.left{ background-position:left center; }
.right{ background-position:right center; }

/* Flipping sheet */
.sheet{
  position:absolute;
  inset:0;
  transform-origin:left center;
  transform-style:preserve-3d;
  will-change: transform;
}

.leaf{
  position:absolute;
  left:50%;
  width:50%;
  height:100%;
  transform-origin:left center;
  transform-style:preserve-3d;
}

.side{
  position:absolute;
  inset:0;
  backface-visibility:hidden;
  background-size:200% 100%;
  background-repeat:no-repeat;
}
.side.front{ background-position:right center; }
.side.back{
  transform:rotateY(180deg);
  background-position:left center;
}

.sheet.anim{
  transition:transform .6s cubic-bezier(.2,.8,.2,1);
}
</style>
</head>

<body>

<div class="topbar">
  <div class="pill">
    <button id="prevBtn">‚¨Ö Prev</button>
    <button id="nextBtn">Next ‚û°</button>
  </div>
</div>

<div class="stage" id="stage">
  <div class="book">
    <div class="cover"></div>

    <div class="pages" id="pages">
      <div class="baseSpread">
        <div class="half left" id="leftPage"></div>
        <div class="half right" id="rightPage"></div>
      </div>
    </div>
  </div>
</div>

<script>
/* üñºÔ∏è Your images (1 image = 1 spread) */
const photos = [
  "a.jpg",
  "n.jpg",
  "m.jpg"
];

const stage = document.getElementById("stage");
const pagesEl = document.getElementById("pages");
const leftPage = document.getElementById("leftPage");
const rightPage = document.getElementById("rightPage");

let current = 0;
const sheets = [];
let isAnimating = false;

/* Render base spread */
function renderSpread(i){
  leftPage.style.backgroundImage = `url(${photos[i]})`;
  rightPage.style.backgroundImage = `url(${photos[i]})`;
}

/* Create flip sheets */
for(let i=0;i<photos.length;i++){
  const sheet = document.createElement("div");
  sheet.className="sheet";
  sheet.style.zIndex=1000-i;

  const leaf=document.createElement("div");
  leaf.className="leaf";

  const front=document.createElement("div");
  front.className="side front";
  front.style.backgroundImage=`url(${photos[i]})`;

  const back=document.createElement("div");
  back.className="side back";
  back.style.backgroundImage=`url(${photos[i+1]||photos[i]})`;

  leaf.appendChild(front);
  leaf.appendChild(back);
  sheet.appendChild(leaf);

  pagesEl.appendChild(sheet);
  sheets.push(sheet);
}

function setAngle(i, angle, anim=false){
  if(!sheets[i]) return;
  sheets[i].classList.toggle("anim", anim);
  sheets[i].style.transform = `rotateY(${angle}deg)`;
}

/* ‚úÖ Next / Prev actions */
function goNext(){
  if(isAnimating) return;
  if(current >= photos.length - 1) return;

  isAnimating = true;
  setAngle(current, -180, true);

  // transition complete ke baad state update
  const done = () => {
    sheets[current].removeEventListener("transitionend", done);
    current++;
    renderSpread(current);
    isAnimating = false;
  };
  sheets[current].addEventListener("transitionend", done, { once:true });
}

function goPrev(){
  if(isAnimating) return;
  if(current <= 0) return;

  isAnimating = true;
  current--;
  setAngle(current, 0, true);

  const done = () => {
    sheets[current].removeEventListener("transitionend", done);
    renderSpread(current);
    isAnimating = false;
  };
  sheets[current].addEventListener("transitionend", done, { once:true });
}

/* Buttons */
document.getElementById("nextBtn").onclick = goNext;
document.getElementById("prevBtn").onclick = goPrev;

/* ‚úÖ Swipe / Drag Support (Touch + Mouse using Pointer Events) */
let dragging = false;
let startX = 0;
let lastX = 0;

const SWIPE_THRESHOLD = 70;   // px
const EDGE_GUARD = 0.0;       // future use if needed

function onPointerDown(e){
  if(isAnimating) return;

  // Left click only for mouse
  if(e.pointerType === "mouse" && e.button !== 0) return;

  dragging = true;
  startX = e.clientX;
  lastX = startX;

  // Capture pointer so move works even if pointer leaves element
  stage.setPointerCapture?.(e.pointerId);

  // Disable transition during live drag
  if(sheets[current]) sheets[current].classList.remove("anim");
  if(current > 0 && sheets[current-1]) sheets[current-1].classList.remove("anim");
}

function onPointerMove(e){
  if(!dragging || isAnimating) return;
  lastX = e.clientX;

  const dx = lastX - startX;

  // dx < 0 => next (flip current sheet)
  if(dx < 0 && current < photos.length - 1){
    const progress = Math.max(-1, Math.min(0, dx / 260)); // -1..0
    const angle = progress * 180; // 0..-180
    setAngle(current, angle, false);
  }

  // dx > 0 => prev (unflip previous sheet)
  if(dx > 0 && current > 0){
    const progress = Math.max(0, Math.min(1, dx / 260)); // 0..1
    const angle = -180 + (progress * 180); // -180..0
    setAngle(current-1, angle, false);
  }
}

function onPointerUp(e){
  if(!dragging || isAnimating) return;
  dragging = false;

  const dx = lastX - startX;

  // Decide based on threshold
  if(dx <= -SWIPE_THRESHOLD){
    // commit next
    if(current < photos.length - 1){
      // animate to -180
      setAngle(current, -180, true);
      isAnimating = true;

      const done = () => {
        sheets[current].removeEventListener("transitionend", done);
        current++;
        renderSpread(current);
        isAnimating = false;
      };
      sheets[current].addEventListener("transitionend", done, { once:true });
      return;
    }
  }

  if(dx >= SWIPE_THRESHOLD){
    // commit prev
    if(current > 0){
      setAngle(current-1, 0, true);
      isAnimating = true;

      const done = () => {
        sheets[current-1].removeEventListener("transitionend", done);
        renderSpread(current);
        isAnimating = false;
      };
      sheets[current-1].addEventListener("transitionend", done, { once:true });
      return;
    }
  }

  // Otherwise cancel: snap back
  if(dx < 0 && current < photos.length - 1){
    setAngle(current, 0, true);
  }
  if(dx > 0 && current > 0){
    setAngle(current-1, -180, true);
  }
}

stage.addEventListener("pointerdown", onPointerDown);
stage.addEventListener("pointermove", onPointerMove);
stage.addEventListener("pointerup", onPointerUp);
stage.addEventListener("pointercancel", onPointerUp);

/* Initial */
renderSpread(0);
</script>

</body>
</html>